{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Main.ts","webpack:///./src/shader/Cube.fs","webpack:///./src/shader/Cube.vs","webpack:///./src/utils/ThreeDMath.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","positions","indices","faceColors","normals","this","draw","canvas","document","querySelector","gl","getContext","console","log","program","createProgram","vertexShader","loadShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","useProgram","clearColor","clearDepth","enable","DEPTH_TEST","depthFunc","LEQUAL","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","drawScene","positionLoc","getAttribLocation","worldViewProjectionLoc","getUniformLocation","modelViewMatrixLoc","projectionMatrixLoc","vertexColor","vertexNormal","lightDirection","lightVec","Float32Array","uniform3fv","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","indicesBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","vertexColorBuff","normalBuffer","window","requestAnimationFrame","render","clock","filedOfView","Math","PI","aspect","clientWidth","clientHeight","projection","perspective","eye","view","lookAt","worldViewProjection","multiplyMatrix","uniformMatrix4fv","modelMatrix","mat4","rotate","drawElements","TRIANGLES","length","UNSIGNED_SHORT","type","source","shader","createShader","shaderSource","compileShader","ThreeDMath","out","a","b","aLength","sqrt","v","v0","v1","v2","rad","axis","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","b00","b01","b02","b10","b11","b12","b20","b21","b22","x","y","z","len","abs","EPSILON","sin","cos","a30","a31","a32","a33","b03","b13","b23","b30","b31","b32","b33","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","angle","near","far","f","tan","rangeInv","target","up","vz","normalize","subVector","vx","cross","vy","inverse","dot","cameraLookAt"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import CubeFs from \"./shader/Cube.fs\"\r\nimport CubeVs from \"./shader/Cube.vs\"\r\nimport ThreeDMath from \"./utils/ThreeDMath\";\r\n\r\nclass Main {\r\n\tprivate gl:  WebGLRenderingContext;\r\n\tprivate canvas: HTMLCanvasElement\r\n\r\n\r\n\r\n\t// 正方体顶点\r\n\tprivate positions: number[] = [\r\n\t\t// Front face\r\n\t\t-1.0, -1.0,  1.0,\r\n\t\t1.0, -1.0,  1.0,\r\n\t\t1.0,  1.0,  1.0,\r\n\t\t-1.0,  1.0,  1.0,\r\n\r\n\t\t// Back face\r\n\t\t-1.0, -1.0, -1.0,\r\n\t\t-1.0,  1.0, -1.0,\r\n\t\t1.0,  1.0, -1.0,\r\n\t\t1.0, -1.0, -1.0,\r\n\r\n\t\t// Top face\r\n\t\t-1.0,  1.0, -1.0,\r\n\t\t-1.0,  1.0,  1.0,\r\n\t\t1.0,  1.0,  1.0,\r\n\t\t1.0,  1.0, -1.0,\r\n\r\n\t\t// Bottom face\r\n\t\t-1.0, -1.0, -1.0,\r\n\t\t1.0, -1.0, -1.0,\r\n\t\t1.0, -1.0,  1.0,\r\n\t\t-1.0, -1.0,  1.0,\r\n\r\n\t\t// Right face\r\n\t\t1.0, -1.0, -1.0,\r\n\t\t1.0,  1.0, -1.0,\r\n\t\t1.0,  1.0,  1.0,\r\n\t\t1.0, -1.0,  1.0,\r\n\r\n\t\t// Left face\r\n\t\t-1.0, -1.0, -1.0,\r\n\t\t-1.0, -1.0,  1.0,\r\n\t\t-1.0,  1.0,  1.0,\r\n\t\t-1.0,  1.0, -1.0,\r\n\t];\r\n\r\n\tprivate indices: number[] = [\r\n\t\t0,  1,  2,      0,  2,  3,    // front\r\n\t\t4,  5,  6,      4,  6,  7,    // back\r\n\t\t8,  9,  10,     8,  10, 11,   // top\r\n\t\t12, 13, 14,     12, 14, 15,   // bottom\r\n\t\t16, 17, 18,     16, 18, 19,   // right\r\n\t\t20, 21, 22,     20, 22, 23,   // left\r\n\t];\r\n\r\n\t// 正方体面颜色\r\n\tprivate faceColors = [\r\n\t\t1.0,  1.0,  1.0,  1.0,    // Front face: white\r\n\t\t1.0,  1.0,  1.0,  1.0,    // Front face: white\r\n\t\t1.0,  1.0,  1.0,  1.0,    // Front face: white\r\n\t\t1.0,  1.0,  1.0,  1.0,    // Front face: white\r\n\r\n\t\t1.0,  0.0,  0.0,  1.0,    // Back face: red\r\n\t\t1.0,  0.0,  0.0,  1.0,    // Back face: red\r\n\t\t1.0,  0.0,  0.0,  1.0,    // Back face: red\r\n\t\t1.0,  0.0,  0.0,  1.0,    // Back face: red\r\n\r\n\t\t0.0,  1.0,  0.0,  1.0,    // Top face: green\r\n\t\t0.0,  1.0,  0.0,  1.0,    // Top face: green\r\n\t\t0.0,  1.0,  0.0,  1.0,    // Top face: green\r\n\t\t0.0,  1.0,  0.0,  1.0,    // Top face: green\r\n\r\n\t\t0.0,  0.0,  1.0,  1.0,    // Bottom face: blue\r\n\t\t0.0,  0.0,  1.0,  1.0,    // Bottom face: blue\r\n\t\t0.0,  0.0,  1.0,  1.0,    // Bottom face: blue\r\n\t\t0.0,  0.0,  1.0,  1.0,    // Bottom face: blue\r\n\r\n\t\t1.0,  1.0,  0.0,  1.0,    // Right face: yellow\r\n\t\t1.0,  1.0,  0.0,  1.0,    // Right face: yellow\r\n\t\t1.0,  1.0,  0.0,  1.0,    // Right face: yellow\r\n\t\t1.0,  1.0,  0.0,  1.0,    // Right face: yellow\r\n\r\n\t\t1.0,  0.0,  1.0,  1.0,    // Left face: purple\r\n\t\t1.0,  0.0,  1.0,  1.0,    // Left face: purple\r\n\t\t1.0,  0.0,  1.0,  1.0,    // Left face: purple\r\n\t\t1.0,  0.0,  1.0,  1.0    // Left face: purple\r\n\t];\r\n\r\n\t// 平面法向量\r\n\tprivate normals = [\r\n\t\t// Front face\r\n\t\t0,0,1,\r\n\t\t0,0,1,\r\n\t\t0,0,1,\r\n\t\t0,0,1,\r\n\r\n\t\t// Back face\r\n\t\t0,0,-1,\r\n\t\t0,0,-1,\r\n\t\t0,0,-1,\r\n\t\t0,0,-1,\r\n\r\n\t\t// Top face\r\n\t\t0,1,0,\r\n\t\t0,1,0,\r\n\t\t0,1,0,\r\n\t\t0,1,0,\r\n\r\n\t\t// Bottom face\r\n\t\t0,-1,0,\r\n\t\t0,-1,0,\r\n\t\t0,-1,0,\r\n\t\t0,-1,0,\r\n\r\n\t\t// Right face\r\n\t\t1,0,0,\r\n\t\t1,0,0,\r\n\t\t1,0,0,\r\n\t\t1,0,0,\r\n\r\n\t\t// Left face\r\n\t\t-1,0,0,\r\n\t\t-1,0,0,\r\n\t\t-1,0,0,\r\n\t\t-1,0,0,\r\n\t]\r\n\r\n\tprivate worldViewProjectionLoc: WebGLUniformLocation;\r\n\tprivate modelViewMatrixLoc: WebGLUniformLocation;\r\n\tprivate projectionMatrixLoc: WebGLUniformLocation;\r\n\r\n\tconstructor() {\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\tprivate draw() {  \r\n\t\t// print11();\r\n\r\n\t\t// 获取 <canvas> 元素\r\n\t\tlet canvas = document.querySelector(\"#glcanvas\") as HTMLCanvasElement;\r\n\t\tthis.canvas = canvas;\r\n\r\n\t\t// 获取WebGL渲染上下文\r\n\t\tlet gl = canvas.getContext('webgl');\r\n\t\tthis.gl = gl;\r\n\r\n\r\n\t\tif (!gl) {\r\n\t\t\tconsole.log('你的浏览器不支持webgl');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 创建程序对象\r\n\t\tlet program = gl.createProgram();\r\n\r\n\t\tconst vertexShader = this.loadShader(gl, gl.VERTEX_SHADER, CubeVs); //创建顶点着色器对象\r\n\t\tconst fragmentShader = this.loadShader(gl, gl.FRAGMENT_SHADER, CubeFs);//创建片元着色器对象\r\n\r\n\t\t// 为程序对象分配着色器\r\n\t\tgl.attachShader(program, vertexShader);\r\n\t\tgl.attachShader(program, fragmentShader);\r\n\r\n\t\t// 连接程序对象\r\n\t\tgl.linkProgram(program);\r\n\r\n\t\t// 使用程序对象\r\n\t\tgl.useProgram(program);\r\n\r\n\t\t// 指定清空<canvas>的颜色\r\n\t\tgl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n\t\t// 指定深度\r\n\t\tgl.clearDepth(1.0);\r\n\t\t// 开启深度检测\r\n\t\tgl.enable(gl.DEPTH_TEST);\r\n\t\t// 深度小等于时渲染\r\n\t\tgl.depthFunc(gl.LEQUAL);\r\n\t\t// 清空<canvas>\r\n\t\tgl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n\t\tgl.useProgram(program);\r\n\t\t// 绘制图形\r\n\t\tthis.drawScene(gl, program);\r\n  \t}\r\n\r\n\tprivate drawScene(gl: WebGLRenderingContext, program: WebGLProgram) {\r\n\t\t// 获取在着色器中声明的变量\r\n\t\tlet positionLoc = gl.getAttribLocation(program, \"a_position\");\r\n\t\tthis.worldViewProjectionLoc = gl.getUniformLocation(program, \"u_worldViewProjection\");\r\n\t\tthis.modelViewMatrixLoc = gl.getUniformLocation(program, \"uModelViewMatrix\");\r\n\t\tthis.projectionMatrixLoc = gl.getUniformLocation(program, \"uProjectionMatrix\");\r\n\t\tlet vertexColor = gl.getAttribLocation(program, \"aVertexColor\");\r\n\t\tlet vertexNormal = gl.getAttribLocation(program, \"a_normal\");\r\n\r\n\t\tlet lightDirection = gl.getUniformLocation(program,'u_light');\r\n\t\tlet lightVec =  new Float32Array([0.1,0.3,0.8]);\r\n\t\tgl.uniform3fv(\r\n\t\t\tlightDirection,\r\n\t\t\tlightVec\r\n\t\t)\r\n\r\n\t\t// 正方体\r\n\t\tlet positionBuffer = gl.createBuffer();\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\r\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(this.positions), gl.STATIC_DRAW);\r\n\t\tgl.vertexAttribPointer(positionLoc, 3, gl.FLOAT, false, 0, 0);\r\n\t\tgl.enableVertexAttribArray(positionLoc);\r\n\r\n\r\n\t\tlet indicesBuffer = gl.createBuffer();\r\n\t\t// gl.ELEMENT_ARRAY_BUFFER 表示数据是索引\r\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indicesBuffer);\r\n\t\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(this.indices), gl.STATIC_DRAW);\r\n\r\n\t\t// 正方体颜色\r\n\t\tlet vertexColorBuff = gl.createBuffer();\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, vertexColorBuff);\r\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(this.faceColors), gl.STATIC_DRAW);\r\n\t\tgl.vertexAttribPointer(vertexColor, 4, gl.FLOAT, false, 0, 0);\r\n\t\tgl.enableVertexAttribArray(vertexColor);\r\n\r\n\t\t// 法向量\r\n\t\tlet normalBuffer = gl.createBuffer();\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, normalBuffer)\r\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(this.normals), gl.STATIC_DRAW);\r\n\t\tgl.vertexAttribPointer(vertexNormal, 3, gl.FLOAT, false, 0, 0);\r\n\t\tgl.enableVertexAttribArray(vertexNormal);\r\n\r\n\r\n\t\t// 每帧刷新\r\n\t\twindow.requestAnimationFrame(this.render.bind(this));\r\n\t}\r\n\r\n\tprivate render(clock: number) {\r\n\t\t// 毫秒转秒\r\n\t\tclock = clock / 1000;\r\n\r\n\t\tlet gl = this.gl;\r\n\t\tgl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n\t\tgl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n\t\t// 投影矩阵\r\n\t\tlet filedOfView = 45 * Math.PI / 180;\r\n\t\tlet aspect = this.canvas.clientWidth / this.canvas.clientHeight;\r\n\t\tlet projection = ThreeDMath.perspective(filedOfView, aspect, 0.01, 500);\r\n\t\tlet radius = 5;\r\n\r\n\t\t// Math.cos(clock)\r\n\t\tlet eye = [\r\n\t\t\tradius,\r\n\t\t\t1,\r\n\t\t\tradius,\r\n\t\t];\r\n\t\tlet target = [0, 0, 0];\r\n\t\tlet up = [0, 1, 0];\r\n\t\t// 视图矩阵\r\n\t\tlet view = ThreeDMath.lookAt(eye, target, up);\r\n\r\n\t\tlet worldViewProjection = ThreeDMath.multiplyMatrix(view, projection);\r\n\t\tgl.uniformMatrix4fv(this.worldViewProjectionLoc, false, worldViewProjection);\r\n\r\n\t\tlet modelMatrix  = ThreeDMath.mat4();\r\n\r\n\t    modelMatrix = ThreeDMath.rotate(modelMatrix, modelMatrix, clock, [1, 0, 0]);\r\n\r\n\t\tgl.uniformMatrix4fv(this.modelViewMatrixLoc, false, modelMatrix);\r\n\t\tgl.uniformMatrix4fv(this.projectionMatrixLoc, false, worldViewProjection);\r\n\r\n\t\t// gl.drawElements 表示使用索引值来画\r\n\t\t// 第一个参数还是表示要画的线,第二参数表示要画的索引的个数\r\n\t\t// 第三个参数表示索引值的类型，我们用了 Uint16，所以类型是 gl.UNSIGNED_SHORT\r\n\t\t// 最后一个参数是 offset 表示起始偏移\r\n\t\tgl.drawElements(gl.TRIANGLES, this.indices.length, gl.UNSIGNED_SHORT, 0);\r\n\t\trequestAnimationFrame(this.render.bind(this));\r\n\t}\r\n\r\n\tprivate loadShader(gl: WebGLRenderingContext, type: number, source: string) {\r\n\t\t// 创建着色器对象\r\n\t\tconst shader = gl.createShader(type);\r\n\t\t// 向着色器对象中填充着色器\r\n\t\tgl.shaderSource(shader, source);\r\n\t\t// 编译着色器\r\n\t\tgl.compileShader(shader);\r\n\r\n\t\treturn shader;\r\n\t}\r\n}\r\n\r\nnew Main();","export default \"precision mediump float;\\r\\nvarying lowp vec4 vColor;\\r\\nvarying lowp vec3 v_normal;\\r\\n\\r\\n//方向光的方向\\r\\nuniform lowp vec3 u_light;\\r\\n\\r\\nvoid main() {\\r\\n    vec3 normal = normalize(v_normal);\\r\\n    float light = max(dot(normal, u_light), 0.1);\\r\\n    gl_FragColor = vColor;\\r\\n    gl_FragColor.rgb *= light;\\r\\n}\";","export default \"attribute vec4 a_position;\\r\\nuniform mat4 u_worldViewProjection;\\r\\nattribute vec4 aVertexColor;\\r\\n//法向量的变量\\r\\nattribute vec3 a_normal;\\r\\n\\r\\nuniform mat4 uModelViewMatrix;\\r\\nuniform mat4 uProjectionMatrix;\\r\\n\\r\\n\\r\\nvarying lowp vec4 vColor;\\r\\n//将法向量从顶点着色器传递到片元着色器的变量\\r\\nvarying lowp vec3 v_normal;\\r\\n\\r\\nvoid main() {\\r\\n    gl_Position = uModelViewMatrix * uProjectionMatrix * a_position;\\r\\n    vColor = aVertexColor;\\r\\n    v_normal = mat3(uModelViewMatrix) * a_normal;\\r\\n}\";","export default class ThreeDMath {\r\n\tpublic static EPSILON = 0.000001;\r\n\r\n\tpublic static mat4(): number[] {\r\n\t\tvar out = [];\r\n\t\tout[0] = 1;\r\n\t\tout[1] = 0;\r\n\t\tout[2] = 0;\r\n\t\tout[3] = 0;\r\n\t\tout[4] = 0;\r\n\t\tout[5] = 1;\r\n\t\tout[6] = 0;\r\n\t\tout[7] = 0;\r\n\t\tout[8] = 0;\r\n\t\tout[9] = 0;\r\n\t\tout[10] = 1;\r\n\t\tout[11] = 0;\r\n\t\tout[12] = 0;\r\n\t\tout[13] = 0;\r\n\t\tout[14] = 0;\r\n\t\tout[15] = 1;\r\n\t\treturn out;\r\n\t}\r\n\r\n  \tpublic static subVector(a: number[], b: number[]): number[] {\r\n\t\tlet r = [];\r\n\t\tlet aLength = a.length;\r\n\t\tfor (let i = 0; i < aLength; ++i)\r\n\t\t\tr[i] = a[i] - b[i];\r\n\t\treturn r;\r\n\t}\r\n\r\n\tpublic static dot(a: number[], b: number[]): number {\r\n\t\tlet r = 0.0;\r\n\t\tlet aLength = a.length;\r\n\t\tfor (let i = 0; i < aLength; ++i)\r\n\t\t  r += a[i] * b[i];\r\n\t\treturn r;\r\n\t}\r\n\r\n\tpublic static cross(a: number[], b: number[]): number[] {\r\n\t\treturn [a[1] * b[2] - a[2] * b[1],\r\n\t\ta[2] * b[0] - a[0] * b[2],\r\n\t\ta[0] * b[1] - a[1] * b[0]];\r\n\t}\r\n\r\n\t\r\n\tpublic static normalize(a: number[]): number[] {\r\n\t\tlet r = [];\r\n\t\tlet n = 0.0;\r\n\t\tlet aLength = a.length;\r\n\t\tfor (let i = 0; i < aLength; ++i)\r\n\t\t\tn += a[i] * a[i];\r\n\t\tn = Math.sqrt(n);\r\n\t\tif (n > 0.00001) {\r\n\t\t\tfor (let i = 0; i < aLength; ++i)\r\n\t\t\t\tr[i] = a[i] / n;\r\n\t\t} else {\r\n\t\t  \tr = [0,0,0];\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\r\n\r\n\tpublic static transformPoint(m: number[], v: number[]): number[] {\r\n\t\tlet v0 = v[0];\r\n\t\tlet v1 = v[1];\r\n\t\tlet v2 = v[2];\r\n\t\tlet d = v0 * m[0*4+3] + v1 * m[1*4+3] + v2 * m[2*4+3] + m[3*4+3];\r\n\t\treturn [(v0 * m[0*4+0] + v1 * m[1*4+0] + v2 * m[2*4+0] + m[3*4+0]) / d,\r\n\t\t\t\t(v0 * m[0*4+1] + v1 * m[1*4+1] + v2 * m[2*4+1] + m[3*4+1]) / d,\r\n\t\t\t\t(v0 * m[0*4+2] + v1 * m[1*4+2] + v2 * m[2*4+2] + m[3*4+2]) / d];\r\n\t}\r\n\r\n\tpublic static identity(): number[] {\r\n\t\treturn [\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\t\t];\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Rotates a mat4 by the given angle around the given axis\r\n\t *\\\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @param {vec3} axis the axis to rotate around\r\n\t * @returns {mat4} out\r\n\t */\r\n\tpublic static rotate(out: number[], a: number[], rad: number, axis: number[]) {\r\n\t\tvar x = axis[0],\r\n\t\t\ty = axis[1],\r\n\t\t\tz = axis[2];\r\n\t\tvar len = Math.sqrt(x * x + y * y + z * z);\r\n\t\tvar s = void 0,\r\n\t\t\tc = void 0,\r\n\t\t\tt = void 0;\r\n\t\tvar a00 = void 0,\r\n\t\t\ta01 = void 0,\r\n\t\t\ta02 = void 0,\r\n\t\t\ta03 = void 0;\r\n\t\tvar a10 = void 0,\r\n\t\t\ta11 = void 0,\r\n\t\t\ta12 = void 0,\r\n\t\t\ta13 = void 0;\r\n\t\tvar a20 = void 0,\r\n\t\t\ta21 = void 0,\r\n\t\t\ta22 = void 0,\r\n\t\t\ta23 = void 0;\r\n\t\tvar b00 = void 0,\r\n\t\t\tb01 = void 0,\r\n\t\t\tb02 = void 0;\r\n\t\tvar b10 = void 0,\r\n\t\t\tb11 = void 0,\r\n\t\t\tb12 = void 0;\r\n\t\tvar b20 = void 0,\r\n\t\t\tb21 = void 0,\r\n\t\t\tb22 = void 0;\r\n\t\r\n\t\tif (Math.abs(len) < ThreeDMath.EPSILON) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\r\n\t\tlen = 1 / len;\r\n\t\tx *= len;\r\n\t\ty *= len;\r\n\t\tz *= len;\r\n\t\r\n\t\ts = Math.sin(rad);\r\n\t\tc = Math.cos(rad);\r\n\t\tt = 1 - c;\r\n\t\r\n\t\ta00 = a[0];a01 = a[1];a02 = a[2];a03 = a[3];\r\n\t\ta10 = a[4];a11 = a[5];a12 = a[6];a13 = a[7];\r\n\t\ta20 = a[8];a21 = a[9];a22 = a[10];a23 = a[11];\r\n\t\r\n\t\t// Construct the elements of the rotation matrix\r\n\t\tb00 = x * x * t + c;b01 = y * x * t + z * s;b02 = z * x * t - y * s;\r\n\t\tb10 = x * y * t - z * s;b11 = y * y * t + c;b12 = z * y * t + x * s;\r\n\t\tb20 = x * z * t + y * s;b21 = y * z * t - x * s;b22 = z * z * t + c;\r\n\t\r\n\t\t// Perform rotation-specific matrix multiplication\r\n\t\tout[0] = a00 * b00 + a10 * b01 + a20 * b02;\r\n\t\tout[1] = a01 * b00 + a11 * b01 + a21 * b02;\r\n\t\tout[2] = a02 * b00 + a12 * b01 + a22 * b02;\r\n\t\tout[3] = a03 * b00 + a13 * b01 + a23 * b02;\r\n\t\tout[4] = a00 * b10 + a10 * b11 + a20 * b12;\r\n\t\tout[5] = a01 * b10 + a11 * b11 + a21 * b12;\r\n\t\tout[6] = a02 * b10 + a12 * b11 + a22 * b12;\r\n\t\tout[7] = a03 * b10 + a13 * b11 + a23 * b12;\r\n\t\tout[8] = a00 * b20 + a10 * b21 + a20 * b22;\r\n\t\tout[9] = a01 * b20 + a11 * b21 + a21 * b22;\r\n\t\tout[10] = a02 * b20 + a12 * b21 + a22 * b22;\r\n\t\tout[11] = a03 * b20 + a13 * b21 + a23 * b22;\r\n\t\r\n\t\tif (a !== out) {\r\n\t\t\t// If the source and destination differ, copy the unchanged last row\r\n\t\t\tout[12] = a[12];\r\n\t\t\tout[13] = a[13];\r\n\t\t\tout[14] = a[14];\r\n\t\t\tout[15] = a[15];\r\n\t\t}\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tpublic static multiplyMatrix(a: number[], b: number[]): number[] {\r\n\t\tlet a00 = a[0*4+0];\r\n\t\tlet a01 = a[0*4+1];\r\n\t\tlet a02 = a[0*4+2];\r\n\t\tlet a03 = a[0*4+3];\r\n\t\tlet a10 = a[1*4+0];\r\n\t\tlet a11 = a[1*4+1];\r\n\t\tlet a12 = a[1*4+2];\r\n\t\tlet a13 = a[1*4+3];\r\n\t\tlet a20 = a[2*4+0];\r\n\t\tlet a21 = a[2*4+1];\r\n\t\tlet a22 = a[2*4+2];\r\n\t\tlet a23 = a[2*4+3];\r\n\t\tlet a30 = a[3*4+0];\r\n\t\tlet a31 = a[3*4+1];\r\n\t\tlet a32 = a[3*4+2];\r\n\t\tlet a33 = a[3*4+3];\r\n\t\tlet b00 = b[0*4+0];\r\n\t\tlet b01 = b[0*4+1];\r\n\t\tlet b02 = b[0*4+2];\r\n\t\tlet b03 = b[0*4+3];\r\n\t\tlet b10 = b[1*4+0];\r\n\t\tlet b11 = b[1*4+1];\r\n\t\tlet b12 = b[1*4+2];\r\n\t\tlet b13 = b[1*4+3];\r\n\t\tlet b20 = b[2*4+0];\r\n\t\tlet b21 = b[2*4+1];\r\n\t\tlet b22 = b[2*4+2];\r\n\t\tlet b23 = b[2*4+3];\r\n\t\tlet b30 = b[3*4+0];\r\n\t\tlet b31 = b[3*4+1];\r\n\t\tlet b32 = b[3*4+2];\r\n\t\tlet b33 = b[3*4+3];\r\n\t\treturn [a00 * b00 + a01 * b10 + a02 * b20 + a03 * b30,\r\n\t\t\t\ta00 * b01 + a01 * b11 + a02 * b21 + a03 * b31,\r\n\t\t\t\ta00 * b02 + a01 * b12 + a02 * b22 + a03 * b32,\r\n\t\t\t\ta00 * b03 + a01 * b13 + a02 * b23 + a03 * b33,\r\n\t\t\t\ta10 * b00 + a11 * b10 + a12 * b20 + a13 * b30,\r\n\t\t\t\ta10 * b01 + a11 * b11 + a12 * b21 + a13 * b31,\r\n\t\t\t\ta10 * b02 + a11 * b12 + a12 * b22 + a13 * b32,\r\n\t\t\t\ta10 * b03 + a11 * b13 + a12 * b23 + a13 * b33,\r\n\t\t\t\ta20 * b00 + a21 * b10 + a22 * b20 + a23 * b30,\r\n\t\t\t\ta20 * b01 + a21 * b11 + a22 * b21 + a23 * b31,\r\n\t\t\t\ta20 * b02 + a21 * b12 + a22 * b22 + a23 * b32,\r\n\t\t\t\ta20 * b03 + a21 * b13 + a22 * b23 + a23 * b33,\r\n\t\t\t\ta30 * b00 + a31 * b10 + a32 * b20 + a33 * b30,\r\n\t\t\t\ta30 * b01 + a31 * b11 + a32 * b21 + a33 * b31,\r\n\t\t\t\ta30 * b02 + a31 * b12 + a32 * b22 + a33 * b32,\r\n\t\t\t\ta30 * b03 + a31 * b13 + a32 * b23 + a33 * b33];\r\n\t}\r\n\r\n\tpublic static inverse(m: number[]): number[] {\r\n\t\tlet tmp_0 = m[2*4+2] * m[3*4+3];\r\n\t\tlet tmp_1 = m[3*4+2] * m[2*4+3];\r\n\t\tlet tmp_2 = m[1*4+2] * m[3*4+3];\r\n\t\tlet tmp_3 = m[3*4+2] * m[1*4+3];\r\n\t\tlet tmp_4 = m[1*4+2] * m[2*4+3];\r\n\t\tlet tmp_5 = m[2*4+2] * m[1*4+3];\r\n\t\tlet tmp_6 = m[0*4+2] * m[3*4+3];\r\n\t\tlet tmp_7 = m[3*4+2] * m[0*4+3];\r\n\t\tlet tmp_8 = m[0*4+2] * m[2*4+3];\r\n\t\tlet tmp_9 = m[2*4+2] * m[0*4+3];\r\n\t\tlet tmp_10 = m[0*4+2] * m[1*4+3];\r\n\t\tlet tmp_11 = m[1*4+2] * m[0*4+3];\r\n\t\tlet tmp_12 = m[2*4+0] * m[3*4+1];\r\n\t\tlet tmp_13 = m[3*4+0] * m[2*4+1];\r\n\t\tlet tmp_14 = m[1*4+0] * m[3*4+1];\r\n\t\tlet tmp_15 = m[3*4+0] * m[1*4+1];\r\n\t\tlet tmp_16 = m[1*4+0] * m[2*4+1];\r\n\t\tlet tmp_17 = m[2*4+0] * m[1*4+1];\r\n\t\tlet tmp_18 = m[0*4+0] * m[3*4+1];\r\n\t\tlet tmp_19 = m[3*4+0] * m[0*4+1];\r\n\t\tlet tmp_20 = m[0*4+0] * m[2*4+1];\r\n\t\tlet tmp_21 = m[2*4+0] * m[0*4+1];\r\n\t\tlet tmp_22 = m[0*4+0] * m[1*4+1];\r\n\t\tlet tmp_23 = m[1*4+0] * m[0*4+1];\r\n\t\t\r\n\t\tlet t0 = (tmp_0 * m[1*4+1] + tmp_3 * m[2*4+1] + tmp_4 * m[3*4+1]) -\r\n\t\t\t(tmp_1 * m[1*4+1] + tmp_2 * m[2*4+1] + tmp_5 * m[3*4+1]);\r\n\t\tlet t1 = (tmp_1 * m[0*4+1] + tmp_6 * m[2*4+1] + tmp_9 * m[3*4+1]) -\r\n\t\t\t(tmp_0 * m[0*4+1] + tmp_7 * m[2*4+1] + tmp_8 * m[3*4+1]);\r\n\t\tlet t2 = (tmp_2 * m[0*4+1] + tmp_7 * m[1*4+1] + tmp_10 * m[3*4+1]) -\r\n\t\t\t(tmp_3 * m[0*4+1] + tmp_6 * m[1*4+1] + tmp_11 * m[3*4+1]);\r\n\t\tlet t3 = (tmp_5 * m[0*4+1] + tmp_8 * m[1*4+1] + tmp_11 * m[2*4+1]) -\r\n\t\t\t(tmp_4 * m[0*4+1] + tmp_9 * m[1*4+1] + tmp_10 * m[2*4+1]);\r\n\t\t\r\n\t\tlet d = 1.0 / (m[0*4+0] * t0 + m[1*4+0] * t1 + m[2*4+0] * t2 + m[3*4+0] * t3);\r\n\t\t\r\n\t\treturn [d * t0, d * t1, d * t2, d * t3,\r\n\t\t\td * ((tmp_1 * m[1*4+0] + tmp_2 * m[2*4+0] + tmp_5 * m[3*4+0]) -\r\n\t\t\t\t(tmp_0 * m[1*4+0] + tmp_3 * m[2*4+0] + tmp_4 * m[3*4+0])),\r\n\t\t\td * ((tmp_0 * m[0*4+0] + tmp_7 * m[2*4+0] + tmp_8 * m[3*4+0]) -\r\n\t\t\t\t(tmp_1 * m[0*4+0] + tmp_6 * m[2*4+0] + tmp_9 * m[3*4+0])),\r\n\t\t\td * ((tmp_3 * m[0*4+0] + tmp_6 * m[1*4+0] + tmp_11 * m[3*4+0]) -\r\n\t\t\t\t(tmp_2 * m[0*4+0] + tmp_7 * m[1*4+0] + tmp_10 * m[3*4+0])),\r\n\t\t\td * ((tmp_4 * m[0*4+0] + tmp_9 * m[1*4+0] + tmp_10 * m[2*4+0]) -\r\n\t\t\t\t(tmp_5 * m[0*4+0] + tmp_8 * m[1*4+0] + tmp_11 * m[2*4+0])),\r\n\t\t\td * ((tmp_12 * m[1*4+3] + tmp_15 * m[2*4+3] + tmp_16 * m[3*4+3]) -\r\n\t\t\t\t(tmp_13 * m[1*4+3] + tmp_14 * m[2*4+3] + tmp_17 * m[3*4+3])),\r\n\t\t\td * ((tmp_13 * m[0*4+3] + tmp_18 * m[2*4+3] + tmp_21 * m[3*4+3]) -\r\n\t\t\t\t(tmp_12 * m[0*4+3] + tmp_19 * m[2*4+3] + tmp_20 * m[3*4+3])),\r\n\t\t\td * ((tmp_14 * m[0*4+3] + tmp_19 * m[1*4+3] + tmp_22 * m[3*4+3]) -\r\n\t\t\t\t(tmp_15 * m[0*4+3] + tmp_18 * m[1*4+3] + tmp_23 * m[3*4+3])),\r\n\t\t\td * ((tmp_17 * m[0*4+3] + tmp_20 * m[1*4+3] + tmp_23 * m[2*4+3]) -\r\n\t\t\t\t(tmp_16 * m[0*4+3] + tmp_21 * m[1*4+3] + tmp_22 * m[2*4+3])),\r\n\t\t\td * ((tmp_14 * m[2*4+2] + tmp_17 * m[3*4+2] + tmp_13 * m[1*4+2]) -\r\n\t\t\t\t(tmp_16 * m[3*4+2] + tmp_12 * m[1*4+2] + tmp_15 * m[2*4+2])),\r\n\t\t\td * ((tmp_20 * m[3*4+2] + tmp_12 * m[0*4+2] + tmp_19 * m[2*4+2]) -\r\n\t\t\t\t(tmp_18 * m[2*4+2] + tmp_21 * m[3*4+2] + tmp_13 * m[0*4+2])),\r\n\t\t\td * ((tmp_18 * m[1*4+2] + tmp_23 * m[3*4+2] + tmp_15 * m[0*4+2]) -\r\n\t\t\t\t(tmp_22 * m[3*4+2] + tmp_14 * m[0*4+2] + tmp_19 * m[1*4+2])),\r\n\t\t\td * ((tmp_22 * m[2*4+2] + tmp_16 * m[0*4+2] + tmp_21 * m[1*4+2]) -\r\n\t\t\t\t(tmp_20 * m[1*4+2] + tmp_23 * m[2*4+2] + tmp_17 * m[0*4+2]))];\r\n\t}\r\n\r\n\r\n\tpublic static perspective(angle: number, aspect: number, near: number, far: number): number[] {\r\n\t\tlet f = Math.tan(Math.PI * 0.5 - 0.5 * angle);\r\n\t\tlet rangeInv = 1.0 / (near - far);\r\n\t  \r\n\t\treturn [\r\n\t\t  f / aspect, 0, 0, 0,\r\n\t\t  0, f, 0, 0,\r\n\t\t  0, 0, (near + far) * rangeInv, -1,\r\n\t\t  0, 0, near * far * rangeInv * 2, 0\r\n\t\t];\r\n\t}\r\n\r\n\tpublic static cameraLookAt(eye: number[], target: number[], up: number[]): number[] {\r\n\t\tlet vz = ThreeDMath.normalize(ThreeDMath.subVector(eye, target));\r\n\t\tlet vx = ThreeDMath.normalize(ThreeDMath.cross(up, vz));\r\n\t\tlet vy = ThreeDMath.cross(vz, vx);\r\n\t  \r\n\t\treturn ThreeDMath.inverse([\r\n\t\t   vx[0], vx[1], vx[2], 0,\r\n\t\t   vy[0], vy[1], vy[2], 0,\r\n\t\t   vz[0], vz[1], vz[2], 0,\r\n\t\t   -ThreeDMath.dot(vx, eye),\r\n\t\t   -ThreeDMath.dot(vy, eye),\r\n\t\t   -ThreeDMath.dot(vz, eye), 1]);\r\n\t}\r\n\r\n\r\n\tpublic static lookAt(eye: number[], target: number[], up: number[]): number[] {\r\n\t\treturn ThreeDMath.inverse(ThreeDMath.cameraLookAt(eye, target, up));\r\n\t}\r\n}\r\n"],"sourceRoot":""}