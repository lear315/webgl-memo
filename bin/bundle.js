!function(r){var e={};function t(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return r[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=r,t.c=e,t.d=function(r,e,o){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:o})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var n in r)t.d(o,n,function(e){return r[e]}.bind(null,n));return o},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=0)}([function(r,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t(1),n=t(2),a=t(3);new class{constructor(){this.positions=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],this.indices=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],this.faceColors=[1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],this.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],this.texCoords=[1,1,0,1,0,0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],this._image=new Image,this._image.onload=()=>{this._image2=new Image,this._image2.onload=()=>{this.draw()},this._image2.src="../res/foot.png"},this._image.src="../res/img.png"}draw(){let r=document.querySelector("#glcanvas");this.canvas=r;let e=r.getContext("webgl");if(this.gl=e,!e)return void console.log("你的浏览器不支持webgl");let t=e.createProgram();const a=this.loadShader(e,e.VERTEX_SHADER,n.default),i=this.loadShader(e,e.FRAGMENT_SHADER,o.default);e.attachShader(t,a),e.attachShader(t,i),e.linkProgram(t),e.useProgram(t),e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.useProgram(t),this.drawScene(e,t)}drawScene(r,e){let t=r.getAttribLocation(e,"a_position");this.worldViewProjectionLoc=r.getUniformLocation(e,"u_worldViewProjection"),this.modelViewMatrixLoc=r.getUniformLocation(e,"uModelViewMatrix"),this.projectionMatrixLoc=r.getUniformLocation(e,"uProjectionMatrix");let o=r.getAttribLocation(e,"aVertexColor"),n=r.getAttribLocation(e,"a_normal"),a=r.getAttribLocation(e,"a_TexCoord"),i=r.getUniformLocation(e,"u_Sampler"),l=r.getUniformLocation(e,"u_Sampler2"),c=r.createTexture();r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,c),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGB,r.RGB,r.UNSIGNED_BYTE,this._image),r.uniform1i(i,0);let u=r.createTexture();r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,u),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,this._image2),r.uniform1i(l,1);let s=r.getUniformLocation(e,"u_light"),_=new Float32Array([0,1,0]);r.uniform3fv(s,_);let f=r.getUniformLocation(e,"u_lightColor"),m=new Float32Array([1,1,1]);r.uniform3fv(f,m);let d=r.getUniformLocation(e,"u_eyePos"),T=new Float32Array([.5,.5,0]);r.uniform3fv(d,T);let E=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,E),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.positions),r.STATIC_DRAW),r.vertexAttribPointer(t,3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(t);let g=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,g),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.texCoords),r.STATIC_DRAW),r.vertexAttribPointer(a,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(a);let v=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,v),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),r.STATIC_DRAW);let A=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,A),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.faceColors),r.STATIC_DRAW),r.vertexAttribPointer(o,4,r.FLOAT,!1,0,0),r.enableVertexAttribArray(o);let R=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,R),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.normals),r.STATIC_DRAW),r.vertexAttribPointer(n,3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(n),window.requestAnimationFrame(this.render.bind(this))}render(r){r/=1e3;let e=this.gl;e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);let t=45*Math.PI/180,o=this.canvas.clientWidth/this.canvas.clientHeight,n=a.default.perspective(t,o,.01,500),i=a.default.lookAt([6,0,0],[0,0,0],[0,1,0]),l=a.default.multiplyMatrix(i,n);e.uniformMatrix4fv(this.worldViewProjectionLoc,!1,l);let c=a.default.mat4();c=a.default.rotate(c,r/2,[.2,.2,1]),c=a.default.multiplyMatrix(c,i),e.uniformMatrix4fv(this.modelViewMatrixLoc,!1,c),e.uniformMatrix4fv(this.projectionMatrixLoc,!1,n),e.drawElements(e.TRIANGLES,this.indices.length,e.UNSIGNED_SHORT,0),requestAnimationFrame(this.render.bind(this))}loadShader(r,e,t){const o=r.createShader(e);return r.shaderSource(o,t),r.compileShader(o),o}}},function(r,e,t){"use strict";t.r(e),e.default="precision mediump float;\r\nvarying lowp vec3 v_normal;\r\n\r\n//方向光的方向\r\nuniform lowp vec3 u_light;\r\n\r\n//方向观察者的坐标\r\nuniform lowp vec3 u_eyePos;\r\n\r\n//方向光的颜色\r\nuniform lowp vec3 u_lightColor;\r\n\r\nvarying lowp vec3 v_fragpos;\r\nvarying vec2 v_TexCoord;\r\nuniform sampler2D u_Sampler;\r\nuniform sampler2D u_Sampler2;\r\n\r\nvarying vec2 v_TexCoord1;\r\n\r\nvoid main() {\r\n    vec3 normal = normalize(v_normal);\r\n   \r\n\r\n    vec4 acolor = texture2D(u_Sampler, v_TexCoord);\r\n    vec4 bcolor = texture2D(u_Sampler2, v_TexCoord1);\r\n\r\n\r\n    gl_FragColor = vec4(bcolor.a * bcolor.rgb + (1.0 - bcolor.a) * acolor.rgb ,1.0);\r\n\r\n    // 环境光照\r\n    vec3 ambientLight = gl_FragColor.rgb * u_lightColor * 0.5;\r\n\r\n    // 漫反射光照\r\n    float light = max(dot(normal, u_light), 0.0);\r\n    vec3 diffuseLight = gl_FragColor.rgb * light;\r\n\r\n    // 高光\r\n    float specularStrength = 0.8;\r\n    vec3 eyeDir = normalize(u_eyePos - v_fragpos);\r\n    vec3 reflectDir = reflect(-u_light, normal);\r\n    float spec = pow(max(dot(eyeDir, reflectDir), 0.0), 32.0);\r\n    vec3 specular = specularStrength * spec * u_lightColor;\r\n    vec3 specularLight = gl_FragColor.rgb * specular;\r\n\r\n    gl_FragColor.rgb = ambientLight + diffuseLight + specularLight;\r\n}"},function(r,e,t){"use strict";t.r(e),e.default="attribute vec4 a_position;\r\nuniform mat4 u_worldViewProjection;\r\nattribute vec4 aVertexColor;\r\n//法向量的变量\r\nattribute vec3 a_normal;\r\n\r\nuniform mat4 uModelViewMatrix;\r\nuniform mat4 uProjectionMatrix;\r\n\r\n\r\nvarying lowp vec4 vColor;\r\n//将法向量从顶点着色器传递到片元着色器的变量\r\nvarying lowp vec3 v_normal;\r\n\r\nvarying lowp vec3 v_fragpos;\r\n\r\nattribute vec2 a_TexCoord;\r\nvarying vec2 v_TexCoord;\r\n\r\nvarying vec2 v_TexCoord1;\r\n\r\nvoid main() {\r\n    gl_Position = uProjectionMatrix * uModelViewMatrix *  a_position;\r\n    vColor = aVertexColor;\r\n    v_normal = mat3(uModelViewMatrix) * a_normal;\r\n    v_fragpos = vec3(uModelViewMatrix * a_position);\r\n    v_TexCoord = a_TexCoord;\r\n    v_TexCoord1.x = (a_TexCoord.x - 0.5 * (1.0-0.25) ) * 4.0;\r\n    v_TexCoord1.y = (a_TexCoord.y - 0.5 * (1.0-0.25) ) * 4.0;\r\n}"},function(r,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class o{static mat4(){var r=[];return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}static subVector(r,e){let t=[],o=r.length;for(let n=0;n<o;++n)t[n]=r[n]-e[n];return t}static dot(r,e){let t=0,o=r.length;for(let n=0;n<o;++n)t+=r[n]*e[n];return t}static cross(r,e){return[r[1]*e[2]-r[2]*e[1],r[2]*e[0]-r[0]*e[2],r[0]*e[1]-r[1]*e[0]]}static normalize(r){let e=[],t=0,o=r.length;for(let e=0;e<o;++e)t+=r[e]*r[e];if(t=Math.sqrt(t),t>1e-5)for(let n=0;n<o;++n)e[n]=r[n]/t;else e=[0,0,0];return e}static transformPoint(r,e){let t=e[0],o=e[1],n=e[2],a=t*r[3]+o*r[7]+n*r[11]+r[15];return[(t*r[0]+o*r[4]+n*r[8]+r[12])/a,(t*r[1]+o*r[5]+n*r[9]+r[13])/a,(t*r[2]+o*r[6]+n*r[10]+r[14])/a]}static identity(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}static rotate(r,e,t){var n=[];n=r.concat([]);var a,i,l,c,u,s,_,f,m,d,T,E,g,v,A,R,h,x,p,b,F,L,P,U,M=t[0],y=t[1],C=t[2],w=Math.sqrt(M*M+y*y+C*C);return Math.abs(w)<o.EPSILON?null:(M*=w=1/w,y*=w,C*=w,a=Math.sin(e),l=1-(i=Math.cos(e)),c=r[0],u=r[1],s=r[2],_=r[3],f=r[4],m=r[5],d=r[6],T=r[7],E=r[8],g=r[9],v=r[10],A=r[11],R=M*M*l+i,h=y*M*l+C*a,x=C*M*l-y*a,p=M*y*l-C*a,b=y*y*l+i,F=C*y*l+M*a,L=M*C*l+y*a,P=y*C*l-M*a,U=C*C*l+i,n[0]=c*R+f*h+E*x,n[1]=u*R+m*h+g*x,n[2]=s*R+d*h+v*x,n[3]=_*R+T*h+A*x,n[4]=c*p+f*b+E*F,n[5]=u*p+m*b+g*F,n[6]=s*p+d*b+v*F,n[7]=_*p+T*b+A*F,n[8]=c*L+f*P+E*U,n[9]=u*L+m*P+g*U,n[10]=s*L+d*P+v*U,n[11]=_*L+T*P+A*U,r!==n&&(n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n)}static multiplyMatrix(r,e){let t=r[0],o=r[1],n=r[2],a=r[3],i=r[4],l=r[5],c=r[6],u=r[7],s=r[8],_=r[9],f=r[10],m=r[11],d=r[12],T=r[13],E=r[14],g=r[15],v=e[0],A=e[1],R=e[2],h=e[3],x=e[4],p=e[5],b=e[6],F=e[7],L=e[8],P=e[9],U=e[10],M=e[11],y=e[12],C=e[13],w=e[14],D=e[15];return[t*v+o*x+n*L+a*y,t*A+o*p+n*P+a*C,t*R+o*b+n*U+a*w,t*h+o*F+n*M+a*D,i*v+l*x+c*L+u*y,i*A+l*p+c*P+u*C,i*R+l*b+c*U+u*w,i*h+l*F+c*M+u*D,s*v+_*x+f*L+m*y,s*A+_*p+f*P+m*C,s*R+_*b+f*U+m*w,s*h+_*F+f*M+m*D,d*v+T*x+E*L+g*y,d*A+T*p+E*P+g*C,d*R+T*b+E*U+g*w,d*h+T*F+E*M+g*D]}static inverse(r){let e=r[10]*r[15],t=r[14]*r[11],o=r[6]*r[15],n=r[14]*r[7],a=r[6]*r[11],i=r[10]*r[7],l=r[2]*r[15],c=r[14]*r[3],u=r[2]*r[11],s=r[10]*r[3],_=r[2]*r[7],f=r[6]*r[3],m=r[8]*r[13],d=r[12]*r[9],T=r[4]*r[13],E=r[12]*r[5],g=r[4]*r[9],v=r[8]*r[5],A=r[0]*r[13],R=r[12]*r[1],h=r[0]*r[9],x=r[8]*r[1],p=r[0]*r[5],b=r[4]*r[1],F=e*r[5]+n*r[9]+a*r[13]-(t*r[5]+o*r[9]+i*r[13]),L=t*r[1]+l*r[9]+s*r[13]-(e*r[1]+c*r[9]+u*r[13]),P=o*r[1]+c*r[5]+_*r[13]-(n*r[1]+l*r[5]+f*r[13]),U=i*r[1]+u*r[5]+f*r[9]-(a*r[1]+s*r[5]+_*r[9]),M=1/(r[0]*F+r[4]*L+r[8]*P+r[12]*U);return[M*F,M*L,M*P,M*U,M*(t*r[4]+o*r[8]+i*r[12]-(e*r[4]+n*r[8]+a*r[12])),M*(e*r[0]+c*r[8]+u*r[12]-(t*r[0]+l*r[8]+s*r[12])),M*(n*r[0]+l*r[4]+f*r[12]-(o*r[0]+c*r[4]+_*r[12])),M*(a*r[0]+s*r[4]+_*r[8]-(i*r[0]+u*r[4]+f*r[8])),M*(m*r[7]+E*r[11]+g*r[15]-(d*r[7]+T*r[11]+v*r[15])),M*(d*r[3]+A*r[11]+x*r[15]-(m*r[3]+R*r[11]+h*r[15])),M*(T*r[3]+R*r[7]+p*r[15]-(E*r[3]+A*r[7]+b*r[15])),M*(v*r[3]+h*r[7]+b*r[11]-(g*r[3]+x*r[7]+p*r[11])),M*(T*r[10]+v*r[14]+d*r[6]-(g*r[14]+m*r[6]+E*r[10])),M*(h*r[14]+m*r[2]+R*r[10]-(A*r[10]+x*r[14]+d*r[2])),M*(A*r[6]+b*r[14]+E*r[2]-(p*r[14]+T*r[2]+R*r[6])),M*(p*r[10]+g*r[2]+x*r[6]-(h*r[6]+b*r[10]+v*r[2]))]}static perspective(r,e,t,o){let n=Math.tan(.5*Math.PI-.5*r),a=1/(t-o);return[n/e,0,0,0,0,n,0,0,0,0,(t+o)*a,-1,0,0,t*o*a*2,0]}static cameraLookAt(r,e,t){let n=o.normalize(o.subVector(r,e)),a=o.normalize(o.cross(t,n)),i=o.cross(n,a);return o.inverse([a[0],a[1],a[2],0,i[0],i[1],i[2],0,n[0],n[1],n[2],0,-o.dot(a,r),-o.dot(i,r),-o.dot(n,r),1])}static lookAt(r,e,t){return o.inverse(o.cameraLookAt(r,e,t))}}e.default=o,o.EPSILON=1e-6}]);
//# sourceMappingURL=bundle.js.map