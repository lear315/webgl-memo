!function(r){var e={};function t(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return r[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=r,t.c=e,t.d=function(r,e,o){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:o})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var n in r)t.d(o,n,function(e){return r[e]}.bind(null,n));return o},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=0)}([function(r,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t(1),n=t(2),i=t(3);new class{constructor(){this.positions=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],this.indices=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],this.faceColors=[1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],this.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],this.texCoords=[1,1,0,1,0,0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],this._image=new Image,this._image.onload=()=>{this.draw()},this._image.src="../res/img.png"}draw(){let r=document.querySelector("#glcanvas");this.canvas=r;let e=r.getContext("webgl");if(this.gl=e,!e)return void console.log("你的浏览器不支持webgl");let t=e.createProgram();const i=this.loadShader(e,e.VERTEX_SHADER,n.default),a=this.loadShader(e,e.FRAGMENT_SHADER,o.default);e.attachShader(t,i),e.attachShader(t,a),e.linkProgram(t),e.useProgram(t),e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.useProgram(t),this.drawScene(e,t)}drawScene(r,e){let t=r.getAttribLocation(e,"a_position");this.worldViewProjectionLoc=r.getUniformLocation(e,"u_worldViewProjection"),this.modelViewMatrixLoc=r.getUniformLocation(e,"uModelViewMatrix"),this.projectionMatrixLoc=r.getUniformLocation(e,"uProjectionMatrix");let o=r.getAttribLocation(e,"aVertexColor"),n=r.getAttribLocation(e,"a_normal"),i=r.getAttribLocation(e,"a_TexCoord"),a=r.getUniformLocation(e,"u_Sampler"),l=r.createTexture();r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGB,r.RGB,r.UNSIGNED_BYTE,this._image),r.uniform1i(a,0);let c=r.getUniformLocation(e,"u_light"),u=new Float32Array([0,1,0]);r.uniform3fv(c,u);let s=r.getUniformLocation(e,"u_lightColor"),f=new Float32Array([1,1,1]);r.uniform3fv(s,f);let _=r.getUniformLocation(e,"u_eyePos"),d=new Float32Array([.5,.5,0]);r.uniform3fv(_,d);let m=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,m),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.positions),r.STATIC_DRAW),r.vertexAttribPointer(t,3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(t);let g=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,g),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.texCoords),r.STATIC_DRAW),r.vertexAttribPointer(i,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(i);let h=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,h),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),r.STATIC_DRAW);let v=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,v),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.faceColors),r.STATIC_DRAW),r.vertexAttribPointer(o,4,r.FLOAT,!1,0,0),r.enableVertexAttribArray(o);let A=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,A),r.bufferData(r.ARRAY_BUFFER,new Float32Array(this.normals),r.STATIC_DRAW),r.vertexAttribPointer(n,3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(n),window.requestAnimationFrame(this.render.bind(this))}render(r){r/=1e3;let e=this.gl;e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);let t=45*Math.PI/180,o=this.canvas.clientWidth/this.canvas.clientHeight,n=i.default.perspective(t,o,.01,500),a=i.default.lookAt([6,0,0],[0,0,0],[0,1,0]),l=i.default.multiplyMatrix(a,n);e.uniformMatrix4fv(this.worldViewProjectionLoc,!1,l);let c=i.default.mat4();c=i.default.rotate(c,r/2,[.2,.2,1]),c=i.default.multiplyMatrix(c,a),e.uniformMatrix4fv(this.modelViewMatrixLoc,!1,c),e.uniformMatrix4fv(this.projectionMatrixLoc,!1,n),e.drawElements(e.TRIANGLES,this.indices.length,e.UNSIGNED_SHORT,0),requestAnimationFrame(this.render.bind(this))}loadShader(r,e,t){const o=r.createShader(e);return r.shaderSource(o,t),r.compileShader(o),o}}},function(r,e,t){"use strict";t.r(e),e.default="precision mediump float;\r\nvarying lowp vec3 v_normal;\r\n\r\n//方向光的方向\r\nuniform lowp vec3 u_light;\r\n\r\n//方向观察者的坐标\r\nuniform lowp vec3 u_eyePos;\r\n\r\n//方向光的颜色\r\nuniform lowp vec3 u_lightColor;\r\n\r\nvarying lowp vec3 v_fragpos;\r\nvarying vec2 v_TexCoord;\r\nuniform sampler2D u_Sampler;\r\n\r\nvoid main() {\r\n    vec3 normal = normalize(v_normal);\r\n   \r\n    gl_FragColor = texture2D(u_Sampler, v_TexCoord);\r\n    // 环境光照\r\n    vec3 ambientLight = gl_FragColor.rgb * u_lightColor * 0.4;\r\n\r\n    // 漫反射光照\r\n    float light = max(dot(normal, u_light), 0.0);\r\n    vec3 diffuseLight = gl_FragColor.rgb * light;\r\n\r\n    // 高光\r\n    float specularStrength = 0.8;\r\n    vec3 eyeDir = normalize(u_eyePos - v_fragpos);\r\n    vec3 reflectDir = reflect(-u_light, normal);\r\n    float spec = pow(max(dot(eyeDir, reflectDir), 0.0), 32.0);\r\n    vec3 specular = specularStrength * spec * u_lightColor;\r\n    vec3 specularLight = gl_FragColor.rgb * specular;\r\n\r\n    gl_FragColor.rgb = ambientLight + diffuseLight + specularLight;\r\n}"},function(r,e,t){"use strict";t.r(e),e.default="attribute vec4 a_position;\r\nuniform mat4 u_worldViewProjection;\r\nattribute vec4 aVertexColor;\r\n//法向量的变量\r\nattribute vec3 a_normal;\r\n\r\nuniform mat4 uModelViewMatrix;\r\nuniform mat4 uProjectionMatrix;\r\n\r\n\r\nvarying lowp vec4 vColor;\r\n//将法向量从顶点着色器传递到片元着色器的变量\r\nvarying lowp vec3 v_normal;\r\n\r\nvarying lowp vec3 v_fragpos;\r\n\r\nattribute vec2 a_TexCoord;\r\nvarying vec2 v_TexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = uProjectionMatrix * uModelViewMatrix *  a_position;\r\n    vColor = aVertexColor;\r\n    v_normal = mat3(uModelViewMatrix) * a_normal;\r\n    v_fragpos = vec3(uModelViewMatrix * a_position);\r\n    v_TexCoord = a_TexCoord;\r\n}"},function(r,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class o{static mat4(){var r=[];return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}static subVector(r,e){let t=[],o=r.length;for(let n=0;n<o;++n)t[n]=r[n]-e[n];return t}static dot(r,e){let t=0,o=r.length;for(let n=0;n<o;++n)t+=r[n]*e[n];return t}static cross(r,e){return[r[1]*e[2]-r[2]*e[1],r[2]*e[0]-r[0]*e[2],r[0]*e[1]-r[1]*e[0]]}static normalize(r){let e=[],t=0,o=r.length;for(let e=0;e<o;++e)t+=r[e]*r[e];if(t=Math.sqrt(t),t>1e-5)for(let n=0;n<o;++n)e[n]=r[n]/t;else e=[0,0,0];return e}static transformPoint(r,e){let t=e[0],o=e[1],n=e[2],i=t*r[3]+o*r[7]+n*r[11]+r[15];return[(t*r[0]+o*r[4]+n*r[8]+r[12])/i,(t*r[1]+o*r[5]+n*r[9]+r[13])/i,(t*r[2]+o*r[6]+n*r[10]+r[14])/i]}static identity(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}static rotate(r,e,t){var n=[];n=r.concat([]);var i,a,l,c,u,s,f,_,d,m,g,h,v,A,T,E,R,p,b,x,F,w,L,M,y=t[0],P=t[1],C=t[2],S=Math.sqrt(y*y+P*P+C*C);return Math.abs(S)<o.EPSILON?null:(y*=S=1/S,P*=S,C*=S,i=Math.sin(e),l=1-(a=Math.cos(e)),c=r[0],u=r[1],s=r[2],f=r[3],_=r[4],d=r[5],m=r[6],g=r[7],h=r[8],v=r[9],A=r[10],T=r[11],E=y*y*l+a,R=P*y*l+C*i,p=C*y*l-P*i,b=y*P*l-C*i,x=P*P*l+a,F=C*P*l+y*i,w=y*C*l+P*i,L=P*C*l-y*i,M=C*C*l+a,n[0]=c*E+_*R+h*p,n[1]=u*E+d*R+v*p,n[2]=s*E+m*R+A*p,n[3]=f*E+g*R+T*p,n[4]=c*b+_*x+h*F,n[5]=u*b+d*x+v*F,n[6]=s*b+m*x+A*F,n[7]=f*b+g*x+T*F,n[8]=c*w+_*L+h*M,n[9]=u*w+d*L+v*M,n[10]=s*w+m*L+A*M,n[11]=f*w+g*L+T*M,r!==n&&(n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n)}static multiplyMatrix(r,e){let t=r[0],o=r[1],n=r[2],i=r[3],a=r[4],l=r[5],c=r[6],u=r[7],s=r[8],f=r[9],_=r[10],d=r[11],m=r[12],g=r[13],h=r[14],v=r[15],A=e[0],T=e[1],E=e[2],R=e[3],p=e[4],b=e[5],x=e[6],F=e[7],w=e[8],L=e[9],M=e[10],y=e[11],P=e[12],C=e[13],S=e[14],U=e[15];return[t*A+o*p+n*w+i*P,t*T+o*b+n*L+i*C,t*E+o*x+n*M+i*S,t*R+o*F+n*y+i*U,a*A+l*p+c*w+u*P,a*T+l*b+c*L+u*C,a*E+l*x+c*M+u*S,a*R+l*F+c*y+u*U,s*A+f*p+_*w+d*P,s*T+f*b+_*L+d*C,s*E+f*x+_*M+d*S,s*R+f*F+_*y+d*U,m*A+g*p+h*w+v*P,m*T+g*b+h*L+v*C,m*E+g*x+h*M+v*S,m*R+g*F+h*y+v*U]}static inverse(r){let e=r[10]*r[15],t=r[14]*r[11],o=r[6]*r[15],n=r[14]*r[7],i=r[6]*r[11],a=r[10]*r[7],l=r[2]*r[15],c=r[14]*r[3],u=r[2]*r[11],s=r[10]*r[3],f=r[2]*r[7],_=r[6]*r[3],d=r[8]*r[13],m=r[12]*r[9],g=r[4]*r[13],h=r[12]*r[5],v=r[4]*r[9],A=r[8]*r[5],T=r[0]*r[13],E=r[12]*r[1],R=r[0]*r[9],p=r[8]*r[1],b=r[0]*r[5],x=r[4]*r[1],F=e*r[5]+n*r[9]+i*r[13]-(t*r[5]+o*r[9]+a*r[13]),w=t*r[1]+l*r[9]+s*r[13]-(e*r[1]+c*r[9]+u*r[13]),L=o*r[1]+c*r[5]+f*r[13]-(n*r[1]+l*r[5]+_*r[13]),M=a*r[1]+u*r[5]+_*r[9]-(i*r[1]+s*r[5]+f*r[9]),y=1/(r[0]*F+r[4]*w+r[8]*L+r[12]*M);return[y*F,y*w,y*L,y*M,y*(t*r[4]+o*r[8]+a*r[12]-(e*r[4]+n*r[8]+i*r[12])),y*(e*r[0]+c*r[8]+u*r[12]-(t*r[0]+l*r[8]+s*r[12])),y*(n*r[0]+l*r[4]+_*r[12]-(o*r[0]+c*r[4]+f*r[12])),y*(i*r[0]+s*r[4]+f*r[8]-(a*r[0]+u*r[4]+_*r[8])),y*(d*r[7]+h*r[11]+v*r[15]-(m*r[7]+g*r[11]+A*r[15])),y*(m*r[3]+T*r[11]+p*r[15]-(d*r[3]+E*r[11]+R*r[15])),y*(g*r[3]+E*r[7]+b*r[15]-(h*r[3]+T*r[7]+x*r[15])),y*(A*r[3]+R*r[7]+x*r[11]-(v*r[3]+p*r[7]+b*r[11])),y*(g*r[10]+A*r[14]+m*r[6]-(v*r[14]+d*r[6]+h*r[10])),y*(R*r[14]+d*r[2]+E*r[10]-(T*r[10]+p*r[14]+m*r[2])),y*(T*r[6]+x*r[14]+h*r[2]-(b*r[14]+g*r[2]+E*r[6])),y*(b*r[10]+v*r[2]+p*r[6]-(R*r[6]+x*r[10]+A*r[2]))]}static perspective(r,e,t,o){let n=Math.tan(.5*Math.PI-.5*r),i=1/(t-o);return[n/e,0,0,0,0,n,0,0,0,0,(t+o)*i,-1,0,0,t*o*i*2,0]}static cameraLookAt(r,e,t){let n=o.normalize(o.subVector(r,e)),i=o.normalize(o.cross(t,n)),a=o.cross(n,i);return o.inverse([i[0],i[1],i[2],0,a[0],a[1],a[2],0,n[0],n[1],n[2],0,-o.dot(i,r),-o.dot(a,r),-o.dot(n,r),1])}static lookAt(r,e,t){return o.inverse(o.cameraLookAt(r,e,t))}}e.default=o,o.EPSILON=1e-6}]);
//# sourceMappingURL=bundle.js.map